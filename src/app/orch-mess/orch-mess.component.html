<div class="expander-component">
  <h3 class="component-name">Orchestrate your customer messages</h3>
  <mat-accordion class="accordion">
    <mat-expansion-panel
      (opened)="expansions.defineChannel = true"
      (closed)="expansions.defineChannel = false"
      [expanded]="expansions.defineChannel"
      hideToggle
      #defineChannel
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-icon
            class="exp-icon"
            svgIcon="dyccwc"
            *ngIf="!defineChannel.expanded"
          ></mat-icon>
          <mat-icon
            class="exp-icon"
            svgIcon="dyccwc-open"
            *ngIf="defineChannel.expanded"
          ></mat-icon>
          <div class="exp-title">
            Define your communication channel with customers
          </div>
        </mat-panel-title>
        <mat-panel-description>
          <div class="indicator">
            <mat-icon class="indicator-icon" *ngIf="!defineChannel.expanded"
              >keyboard_arrow_right</mat-icon
            >
            <mat-icon
              class="indicator-icon-selected"
              *ngIf="defineChannel.expanded"
              >keyboard_arrow_down</mat-icon
            >
          </div>
        </mat-panel-description>
      </mat-expansion-panel-header>
      <div class="accordion-content">
        <form
          novalidate
          [formGroup]="channelFormGroup"
          (ngSubmit)="saveChannel()"
        >
          <div>
            <h4 class="lh-17">
              Email Sender Name
              <mat-icon
                svgIcon="infoicon"
                style="margin-left: 6px"
                class="tooltipicon"
                inline="true"
                matTooltip="Use a sender name which is easily recognisable by your customers"
                matTooltipPosition="after"
              >
              </mat-icon>
            </h4>
            <p class="lh-16-fs-12">
              Your customers will receive email from this sender name
            </p>

            <div class="form-container">
              <mat-form-field style="width: 403px" floatLabel="never">
                <input
                  #emailsendername
                  (input)="(emailsendername)"
                  formControlName="senderName"
                  matInput
                  placeholder="Acme"
                />
              </mat-form-field>
            </div>

            <div class="preview-container">
              <div
                style="
                  background-color: #f6f6f6;
                  width: 100%;
                  height: 100%;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                "
              >
                <img
                  src="../../assets/img/emailpre.png"
                  style="width: 124px; height: px"
                  alt="ACME"
                />
              </div>
            </div>

            <h4 class="lh-17">
              Send-from email address
              <mat-icon
                svgIcon="infoicon"
                class="tooltipicon"
                style="margin-left: 6px"
                inline="true"
                matTooltip="Use an email address which is setup to receive incoming emails"
                matTooltipPosition="after"
              >
              </mat-icon>
            </h4>
            <p class="lh-16-fs-12">
              Your customers will receive email from this email address
            </p>

            <div class="form-container">
              <mat-form-field style="width: 403px" floatLabel="never">
                <input
                  #senderEmail
                  (input)="(senderEmail)"
                  matInput
                  formControlName="senderEmail"
                  placeholder="care@acme.com"
                />
              </mat-form-field>
            </div>

            <div
              class="preview-container"
              style="
                background-color: #f6f6f6;
                max-width: 100%;
                min-width: 199px;
              "
            >
              <div
                class="preview-div-body"
                style="
                  background-color: #ffffff;
                  min-width: 100%;
                  width: fit-content;
                  max-height: fit-content;
                  height: 75%;
                  margin: 10px 0 0 10px;
                  border-radius: 0;
                  border-top-left-radius: 10px;
                  padding: 8px;
                  position: unset;
                "
              >
                <div
                  style="
                    color: #999999;
                    flex-direction: column;
                    min-width: 100%;
                  "
                >
                  from: {{ emailsendername.value }} &lt;
                  <p style="display: inline; color: black">
                    {{ senderEmail.value }}
                  </p>
                  &gt;
                </div>
              </div>
            </div>

            <h4 class="lh-17">SMS sender name</h4>
            <p class="lh-16-fs-12" style="margin-bottom: 8px">
              Your customers will receive SMS from this sender name
            </p>

            <div
              style="
                width: fit-content;
                padding: 12px;
                background: #f6f6f6;
                border-radius: 4px;
              "
            >
              <div
                style="
                  font-family: Lato;
                  font-style: normal;
                  font-weight: bold;
                  font-size: 12px;
                  line-height: 12px;
                  /* identical to box height, or 100% */

                  letter-spacing: 0.5px;

                  color: #343434;
                  margin-bottom: 4px;
                "
              >
                {{ smsSenderName }}
              </div>
              <div
                style="
                  font-family: Lato;
                  font-style: normal;
                  font-weight: normal;
                  font-size: 12px;
                  line-height: 16px;
                  /* identical to box height, or 133% */

                  display: flex;
                  align-items: center;
                  letter-spacing: 0.5px;

                  color: #808080;
                "
              >
                Want to customize the sender code? &nbsp;<a
                  style="display: inline"
                  >Learn More</a
                >
              </div>
            </div>

            <div
              class="save-cancel-container"
              *ngIf="isChanged(channelFormGroup)"
            >
              <button class="save-button" type="submit" mat-button>Save</button>
              <button
                mat-button
                type="button"
                (click)="cancel(channelFormGroup, 'defineChannel')"
              >
                Cancel
              </button>
            </div>

            <div
              *ngIf="!isChanged(channelFormGroup)"
              class="save-cancel-container"
            >
              <button
                type="button"
                (click)="expansions.defineChannel = false"
                class="save-button"
                mat-button
              >
                Close
              </button>
            </div>
          </div>
        </form>
      </div>
    </mat-expansion-panel>

    <!--pre>{{ channelFormGroup.value | json }}</pre-->

    <mat-expansion-panel
      (opened)="expansions.custNotifs = true"
      (closed)="expansions.custNotifs = false"
      [expanded]="expansions.custNotifs"
      hideToggle
      #custNotifs
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-icon
            class="exp-icon"
            svgIcon="mycn"
            *ngIf="!custNotifs.expanded"
          ></mat-icon>
          <mat-icon
            class="exp-icon"
            svgIcon="mycn-open"
            *ngIf="custNotifs.expanded"
          ></mat-icon>
          <div class="exp-title">Manage your customer notifications</div>
        </mat-panel-title>
        <mat-panel-description>
          <div class="indicator">
            <mat-icon class="indicator-icon" *ngIf="!custNotifs.expanded"
              >keyboard_arrow_right</mat-icon
            >
            <mat-icon
              class="indicator-icon-selected"
              *ngIf="custNotifs.expanded"
              >keyboard_arrow_down</mat-icon
            >
          </div>
        </mat-panel-description>
      </mat-expansion-panel-header>
      <div class="accordion-content">
        <div>
          <p class="lh-14">
            You can choose to send notifications to customers via Email and SMS
          </p>
          <mat-accordion class="accordion" class="inner-exp">
            <mat-expansion-panel hideToggle #orders>
              <mat-expansion-panel-header style="height: 49px">
                <mat-panel-title>Orders</mat-panel-title>
                <mat-panel-description>
                  <div class="indicator">
                    <mat-icon
                      style="height: fit-content; margin-right: 0"
                      *ngIf="!orders.expanded"
                      >keyboard_arrow_right</mat-icon
                    >
                  </div>
                </mat-panel-description>
              </mat-expansion-panel-header>

              <div class="accordion-content" style="width: 100%">
                <table
                  class="table-container"
                  style="border-collapse: collapse; width: 100%"
                >
                  <tbody>
                    <tr
                      class="notif-table"
                      *ngFor="
                        let notif of getResourceArray('shipment');
                        let i = index
                      "
                    >
                      <td>
                        <div>
                          <h4 style="margin: 16px 0" class="lh-17">
                            {{ notif["description"] }}
                          </h4>
                        </div>
                      </td>

                      <td
                        align="right"
                        style="width: fit-content; height: fit-content"
                      >
                        <div style="display: flex; align-items: center">
                          <mat-icon
                            class="eyecon"
                            (click)="showDialog()"
                            svgIcon="eyecon"
                          ></mat-icon>
                        </div>
                      </td>

                      <td align="right" style="width: 85px; height: 17px">
                        <mat-checkbox
                          #emailChkBox
                          [checked]="
                            notif['isEmailEnabled'] == '1' ? true : false
                          "
                          (change)="
                            recordChanges(
                              notif['resource'],
                              notif['eventSubType'],
                              emailChkBox.checked,
                              smsChkBox.checked
                            )
                          "
                        >
                          <p class="lh-14" style="margin: 0; color: #343434">
                            Email
                          </p>
                        </mat-checkbox>
                      </td>

                      <td align="right" style="width: 85px; height: 17px">
                        <mat-checkbox
                          #smsChkBox
                          [checked]="
                            notif['isSmsEnabled'] == '1' ? true : false
                          "
                          (change)="
                            recordChanges(
                              notif['resource'],
                              notif['eventSubType'],
                              emailChkBox.checked,
                              smsChkBox.checked
                            )
                          "
                        >
                          <p class="lh-14" style="margin: 0; color: #343434">
                            SMS
                          </p>
                        </mat-checkbox>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </mat-expansion-panel>

            <mat-expansion-panel hideToggle #returns>
              <mat-expansion-panel-header style="height: 49px">
                <mat-panel-title>Returns</mat-panel-title>
                <mat-panel-description>
                  <div class="indicator">
                    <mat-icon
                      style="height: fit-content; margin-right: 0"
                      *ngIf="!returns.expanded"
                      >keyboard_arrow_right</mat-icon
                    >
                  </div>
                </mat-panel-description>
              </mat-expansion-panel-header>
              <div class="accordion-content" style="width: 100%">
                <table
                  class="table-container"
                  style="border-collapse: collapse; width: 100%"
                >
                  <tbody>
                    <tr
                      class="notif-table"
                      *ngFor="
                        let notif of getResourceArray('returnshipment');
                        let i = index
                      "
                    >
                      <td>
                        <div>
                          <h4 style="margin: 16px 0" class="lh-17">
                            {{ notif["description"] }}
                          </h4>
                        </div>
                      </td>

                      <td
                        align="right"
                        style="width: fit-content; height: fit-content"
                      >
                        <div style="display: flex; align-items: center">
                          <mat-icon
                            class="eyecon"
                            (click)="showDialog()"
                            svgIcon="eyecon"
                          ></mat-icon>
                        </div>
                      </td>

                      <td align="right" style="width: 85px; height: 17px">
                        <mat-checkbox
                          #emailChkBox
                          [checked]="
                            notif['isEmailEnabled'] == '1' ? true : false
                          "
                          (change)="
                            recordChanges(
                              notif['resource'],
                              notif['eventSubType'],
                              emailChkBox.checked,
                              smsChkBox.checked
                            )
                          "
                        >
                          <p class="lh-14" style="margin: 0; color: #343434">
                            Email
                          </p>
                        </mat-checkbox>
                      </td>

                      <td align="right" style="width: 85px; height: 17px">
                        <mat-checkbox
                          #smsChkBox
                          [checked]="
                            notif['isSmsEnabled'] == '1' ? true : false
                          "
                          (change)="
                            recordChanges(
                              notif['resource'],
                              notif['eventSubType'],
                              emailChkBox.checked,
                              smsChkBox.checked
                            )
                          "
                        >
                          <p class="lh-14" style="margin: 0; color: #343434">
                            SMS
                          </p>
                        </mat-checkbox>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </mat-expansion-panel>

            <mat-expansion-panel hideToggle #refunds>
              <mat-expansion-panel-header style="height: 49px">
                <mat-panel-title>Refunds</mat-panel-title>
                <mat-panel-description>
                  <div class="indicator">
                    <mat-icon
                      style="height: fit-content; margin-right: 0px"
                      *ngIf="!refunds.expanded"
                      >keyboard_arrow_right</mat-icon
                    >
                  </div>
                </mat-panel-description>
              </mat-expansion-panel-header>
              <div class="accordion-content" style="width: 100%">
                <table
                  class="table-container"
                  style="border-collapse: collapse; width: 100%"
                >
                  <tbody>
                    <tr
                      class="notif-table"
                      *ngFor="let notif of getResourceArray('refund')"
                    >
                      <td>
                        <div>
                          <h4 style="margin: 16px 0" class="lh-17">
                            {{ notif["description"] }}
                          </h4>
                        </div>
                      </td>

                      <td
                        align="right"
                        style="width: fit-content; height: fit-content"
                      >
                        <div style="display: flex; align-items: center">
                          <mat-icon
                            class="eyecon"
                            (click)="showDialog()"
                            svgIcon="eyecon"
                          ></mat-icon>
                        </div>
                      </td>

                      <td align="right" style="width: 85px; height: 17px">
                        <mat-checkbox
                          #emailChkBox
                          [checked]="
                            notif['isEmailEnabled'] == '1' ? true : false
                          "
                          (change)="
                            recordChanges(
                              notif['resource'],
                              notif['eventSubType'],
                              emailChkBox.checked,
                              smsChkBox.checked
                            )
                          "
                        >
                          <p class="lh-14" style="margin: 0; color: #343434">
                            Email
                          </p>
                        </mat-checkbox>
                      </td>

                      <td align="right" style="width: 85px; height: 17px">
                        <mat-checkbox
                          #smsChkBox
                          [checked]="
                            notif['isSmsEnabled'] == '1' ? true : false
                          "
                          (change)="
                            recordChanges(
                              notif['resource'],
                              notif['eventSubType'],
                              emailChkBox.checked,
                              smsChkBox.checked
                            )
                          "
                        >
                          <p class="lh-14" style="margin: 0; color: #343434">
                            SMS
                          </p>
                        </mat-checkbox>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </mat-expansion-panel>
          </mat-accordion>

          <div class="save-cancel-container" *ngIf="changes.length">
            <button
              (click)="saveNotifications()"
              class="save-button"
              mat-button
            >
              Save
            </button>
            <button (click)="cancelNotifs()" type="button" mat-button>
              Cancel
            </button>
          </div>

          <div *ngIf="!changes.length" class="save-cancel-container">
            <button
              type="button"
              (click)="expansions.custNotifs = false"
              class="save-button"
              mat-button
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </mat-expansion-panel>
    <!--pre>{{ channelFormGroup.value | json }}</pre-->
  </mat-accordion>
</div>
