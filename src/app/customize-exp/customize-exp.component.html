<div *ngIf="poeFetched" class="expander-component">
  <h3 class="component-name">Customize the experience</h3>

  <mat-accordion class="accordion">
    <mat-expansion-panel
      (opened)="expansions.styleExp = true"
      (closed)="expansions.styleExp = false"
      [expanded]="expansions.styleExp"
      hideToggle
      #stylePanel
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-icon class="exp-icon" svgIcon="sycp"></mat-icon>
          <div class="exp-title">Style Your Customer Portal</div>
        </mat-panel-title>
        <mat-panel-description>
          <div class="indicator">
            <mat-icon class="indicator-icon" *ngIf="!stylePanel.expanded"
              >keyboard_arrow_right</mat-icon
            >
            <mat-icon
              class="indicator-icon-selected"
              *ngIf="stylePanel.expanded"
              >keyboard_arrow_down</mat-icon
            >
          </div>
        </mat-panel-description>
      </mat-expansion-panel-header>
      <div class="accordion-content">
        <form
          novalidate
          [formGroup]="styleFormGroup"
          (ngSubmit)="onSubmit(styleFormGroup)"
        >
          <div>
            <div>
              <h4 class="topic">Upload your brand logo</h4>
              <p class="description">
                Add a PNG, JPG or GIF. Your image may scale upto 154px X 24px
              </p>
              <div
                #logoInputDiv
                *ngIf="appStyle.brandLogoUrl === originalAppStyle.brandLogoUrl"
              >
                <button type="button" mat-button (click)="logoInput.click()">
                  Upload logo
                </button>
                <input
                  formControlName="brandLogoUrl"
                  hidden
                  (input)="selectIcon('brandLogoUrl', $event)"
                  #logoInput
                  type="file"
                />
              </div>

              <div
                *ngIf="
                  !(appStyle.brandLogoUrl === originalAppStyle.brandLogoUrl)
                "
                class="logo-picker-div"
              >
                <div
                  class="logo-picker-image"
                  [style.background-color]="appStyle.backgroundColor"
                >
                  <img
                    class="logo-picker-image"
                    [src]="appStyle.brandLogoUrl"
                    alt="ACME"
                  />
                </div>

                <div>
                  <mat-icon
                    (click)="cancelIconSelect('brandLogoUrl')"
                    style="
                      margin: 0;
                      margin-left: 20px;
                      height: 10px;
                      width: 10px;
                    "
                    svgIcon="crossbutton"
                  ></mat-icon>
                </div>
              </div>

              <div class="preview-container">
                <div class="preview-div">
                  <div
                    class="preview-div-header"
                    [style.background-color]="appStyle.backgroundColor"
                  >
                    <div
                      style="
                        width: 100%;
                        height: 100%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                      "
                    >
                      <img
                        class="image"
                        [src]="appStyle.brandLogoUrl"
                        alt="ACME"
                      />
                    </div>
                  </div>

                  <div class="preview-div-body"></div>
                </div>
              </div>
            </div>

            <br />
            <br />

            <div>
              <h4 class="topic">Upload your favicon</h4>
              <p class="description">
                The optimal size for creating a favicon is 16x16 pixels
              </p>

              <div *ngIf="appStyle.faviconUrl === originalAppStyle.faviconUrl">
                <button type="button" mat-button (click)="faviconInput.click()">
                  Upload Favicon
                </button>
                <input
                  formControlName="faviconUrl"
                  hidden
                  (change)="selectIcon('faviconUrl', $event)"
                  #faviconInput
                  type="file"
                />
              </div>

              <div
                *ngIf="!(appStyle.faviconUrl === originalAppStyle.faviconUrl)"
                class="logo-picker-div"
              >
                <div
                  class="logo-picker-image"
                  [style.background-color]="appStyle.backgroundColor"
                >
                  <img
                    class="logo-picker-image"
                    [src]="appStyle.faviconUrl"
                    alt="ACME"
                  />
                </div>

                <div>
                  <mat-icon
                    (click)="cancelIconSelect('faviconUrl')"
                    style="
                      margin: 0;
                      margin-left: 20px;
                      height: 10px;
                      width: 10px;
                    "
                    svgIcon="crossbutton"
                  ></mat-icon>
                </div>
              </div>

              <div>
                <div class="preview-container">
                  <div
                    class="preview-div"
                    style="
                      background-color: white;
                      border-top-left-radius: 5px;
                      box-shadow: -1px -1px 20px #e7e7e8;
                    "
                  >
                    <div class="preview-tab-container">
                      <div class="dot-container">
                        <span class="dot" style="background: #ed594a"></span>
                        <span class="dot" style="background: #fdd800"></span>
                        <span class="dot" style="background: #5ac05a"></span>
                      </div>
                      <div class="tab-div">
                        <img
                          class="image"
                          style="margin: 2px"
                          [src]="appStyle.faviconUrl"
                          alt="ACME"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <br />
            <br />

            <div>
              <h4 class="topic">Background Color</h4>
              <p class="description">
                Used behind your team profile and other backgrounds
              </p>

              <div class="color-picker-container">
                <input
                  class="color-picker"
                  formControlName="backgroundColor"
                  type="color"
                  [value]="appStyle.backgroundColor"
                  (input)="changeColor($event.target.value, 'backgroundColor')"
                />
                <input
                  formControlName="backgroundColor"
                  [value]="appStyle.backgroundColor"
                  (input)="changeColor($event.target.value, 'backgroundColor')"
                  type="text"
                />
              </div>

              <div class="preview-container">
                <div class="preview-div">
                  <div
                    class="preview-div-header"
                    [style.background-color]="appStyle.backgroundColor"
                  >
                    <div
                      style="
                        width: 100%;
                        height: 100%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                      "
                    >
                      <img
                        class="image"
                        [src]="appStyle.brandLogoUrl"
                        alt="ACME"
                      />
                    </div>
                  </div>
                  <div class="preview-div-body"></div>
                </div>
              </div>
            </div>

            <br />
            <br />

            <div>
              <h4 class="topic">Action Color</h4>
              <p class="description">Used in your action buttons</p>

              <div class="color-picker-container">
                <input
                  formControlName="actionColor"
                  class="color-picker"
                  type="color"
                  [value]="appStyle.actionColor"
                  (input)="changeColor($event.target.value, 'actionColor')"
                />
                <input
                  formControlName="actionColor"
                  [value]="appStyle.actionColor"
                  (input)="changeColor($event.target.value, 'actionColor')"
                  type="text"
                />
              </div>

              <div
                class="preview-container"
                [style.background-color]="appStyle.backgroundColor"
                style="
                  display: flex;
                  align-items: center;
                  justify-content: center;
                "
              >
                <button
                  type="button"
                  [style.background-color]="appStyle.actionColor"
                  style="
                    color: #e7e7e7;
                    border-radius: 10px;
                    border: none;
                    margin: 0;
                    width: 70%;
                    height: 55%;
                  "
                  mat-flat-button
                >
                  BUTTON
                </button>
              </div>
            </div>

            <div>
              <button class="save-button" type="submit" mat-button>Save</button>
              <button type="button" (click)="cancelStyle()" mat-button>
                Cancel
              </button>
            </div>
          </div>
        </form>
      </div>
    </mat-expansion-panel>

    <mat-expansion-panel
      (opened)="expansions.domainExp = true"
      (closed)="expansions.domainExp = false"
      [expanded]="expansions.domainExp"
      hideToggle
      #domainPanel
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-icon class="exp-icon" svgIcon="sytpd"></mat-icon>
          <div class="exp-title">Setup your tracking page domain</div>
        </mat-panel-title>
        <mat-panel-description>
          <div class="indicator">
            <mat-icon class="indicator-icon" *ngIf="!domainPanel.expanded"
              >keyboard_arrow_right</mat-icon
            >
            <mat-icon
              class="indicator-icon-selected"
              *ngIf="domainPanel.expanded"
              >keyboard_arrow_down</mat-icon
            >
          </div>
        </mat-panel-description>
      </mat-expansion-panel-header>
      <div class="accordion-content">
        <div #addDomainDiv *ngIf="!trackingPageDomain.value">
          <h4 class="topic">
            Add your domain
            <mat-icon
              svgIcon="infoicon"
              class="tooltipicon"
              inline="true"
              matTooltip="Rather than registering a new domain name, you can create a subdomain using the domain you already own"
              matTooltipPosition="after"
            >
            </mat-icon>
          </h4>
          <p
            class="description"
            style="
              font-family: Lato;
              font-style: normal;
              font-weight: normal;
              font-size: 12px;
              line-height: 16px;
              /* or 133% */

              letter-spacing: 0.5px;

              color: #808080;
            "
          >
            By default, customers will be directed to https://acme.eshopbox.com
            when accessing the customer portal. To change, add a domain.
            <a>Learn More</a>
          </p>
          <button
            class="save-button"
            style="margin-top: 12px"
            (click)="addDomain()"
            mat-button
          >
            + Add domain
          </button>
        </div>

        <br />

        <div #domainDiv *ngIf="trackingPageDomain.value">
          <form
            novalidate
            [formGroup]="domainFormGroup"
            (ngSubmit)="onSubmit(domainFormGroup)"
          >
            <div style="align-items: center; display: flex">
              <mat-icon
                style="
                  margin-right: 8px;
                  width: 18px;
                  height: 18px;
                  display: inline-block;
                "
                svgIcon="globeicon"
              ></mat-icon>
              <div
                style="
                  margin: auto 0;
                  font-size: 14px;
                  line-height: 17px;
                  color: #333333;
                  float: left;
                "
              >
                {{ trackingPageDomain.value }}
              </div>
              <div class="connected-indicator">
                <mat-icon
                  class="connected-indicator-icon"
                  svgIcon="connected"
                ></mat-icon>
                Connected
              </div>
              <div class="pending-indicator">
                <mat-icon
                  class="connected-indicator-icon"
                  svgIcon="pending"
                ></mat-icon
                >Pending
              </div>

              <mat-icon
                (click)="trackingPageDomain.value = ''"
                style="
                  margin-left: 12px;
                  width: 18px;
                  height: 16px;
                  display: inline-block;
                "
                svgIcon="trashicon"
              ></mat-icon>
            </div>

            <br />

            <div class="tracking-page-info">
              <p>
                Visit the admin console of your domain registrar panel (the
                website you purchased your domain from) and create a CNAME
                Record with the details below.
              </p>
              <br />

              <table style="width: 50%">
                <tr
                  style="
                    text-align: left;
                    font-size: 10px;
                    line-height: 12px;
                    color: #808080;
                  "
                >
                  <th>Type</th>
                  <th>Name</th>
                  <th>Value</th>
                </tr>
                <tr
                  style="
                    text-align: left;
                    font-size: 10px;
                    line-height: 12px;
                    color: #808080;
                  "
                >
                  <td>CNAME</td>
                  <td>acme.domainkey.eshopbox.com</td>
                  <td>Acme</td>
                </tr>
              </table>
            </div>

            <br />

            <div>
              <button class="save-button" type="submit" mat-button>Save</button>
              <button type="button" mat-button>Cancel</button>
            </div>
          </form>
        </div>
      </div>
    </mat-expansion-panel>

    <mat-expansion-panel
      (opened)="expansions.linksExp = true"
      (closed)="expansions.linksExp = false"
      [expanded]="expansions.linksExp"
      #linksPanel
      hideToggle
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-icon class="exp-icon" svgIcon="grltyc"></mat-icon>
          <div class="exp-title">Give relavant links to your customers</div>
        </mat-panel-title>
        <mat-panel-description>
          <div class="indicator">
            <mat-icon class="indicator-icon" *ngIf="!linksPanel.expanded"
              >keyboard_arrow_right</mat-icon
            >
            <mat-icon
              class="indicator-icon-selected"
              *ngIf="linksPanel.expanded"
              >keyboard_arrow_down</mat-icon
            >
          </div>
        </mat-panel-description>
      </mat-expansion-panel-header>
      <div class="accordion-content">
        <form
          novalidate
          [formGroup]="linksFormGroup"
          (ngSubmit)="onSubmit(linksFormGroup)"
        >
          <div>
            <h4 class="topic">Website URL</h4>
            <p class="description">
              Direct customers to your website from the customer portal
            </p>

            <div class="form-container">
              <mat-form-field style="width: 80%" floatLabel="never">
                <input
                  style="width: 100%"
                  matInput
                  placeholder="https://acme.com"
                  formControlName="websiteUrl"
                  (input)="changeLink('websiteUrl', $event.target.value)"
                />
                <mat-error *ngIf="websiteUrl.invalid">{{
                  validateError(websiteUrl)
                }}</mat-error>
              </mat-form-field>
            </div>

            <div class="preview-container" style="overflow: hidden">
              <div
                class="preview-div"
                [style.background-color]="appStyle.backgroundColor"
                style="top: 0; right: 0; width: fit-content; overflow: hidden"
              >
                <div
                  class="preview-div-body"
                  style="
                    top: 0;
                    right: 0;
                    border-radius: 0;
                    border-bottom-left-radius: 10px;
                    overflow: hidden;
                  "
                ></div>
                <div
                  style="
                    padding-bottom: 10%;
                    display: flex;
                    align-items: flex-end;
                    justify-content: center;
                    height: 100%;
                    overflow: hidden;
                  "
                >
                  <h4 *ngIf="links.websiteUrl">
                    Go to&nbsp;<a href="#"> {{ links.websiteUrl }}</a>
                  </h4>
                </div>
              </div>
            </div>

            <h4 class="topic">Support</h4>
            <p class="description">
              Provide help and support to your customers at every step
            </p>

            <div class="form-container">
              <mat-label class="label">
                Support URL
                <mat-icon
                  svgIcon="infoicon"
                  class="tooltipicon"
                  inline="true"
                  matTooltip="Include the Help page or FAQ page of your website"
                  matTooltipPosition="after"
                >
                </mat-icon>
              </mat-label>
              <mat-form-field style="width: 80%" floatLabel="never">
                <input
                  style="width: 100%"
                  formControlName="supportUrl"
                  matInput
                  placeholder="acme.com/help"
                  (input)="changeLink('supportUrl', $event.target.value)"
                />
                <mat-error *ngIf="supportUrl.invalid">{{
                  validateError(supportUrl)
                }}</mat-error>
              </mat-form-field>
            </div>

            <div>
              <table style="width: 80%" cellspacing="0">
                <tr>
                  <td>
                    <div class="form-container">
                      <mat-label class="label"> Support email </mat-label>
                      <mat-form-field floatLabel="never">
                        <input
                          (input)="
                            changeLink('supportEmail', $event.target.value)
                          "
                          formControlName="supportEmail"
                          matInput
                        />
                        <mat-error *ngIf="supportEmail.invalid">{{
                          validateError(supportEmail)
                        }}</mat-error>
                      </mat-form-field>
                    </div>
                  </td>
                  <td>
                    <div class="form-container">
                      <mat-label class="label">
                        Support phone number
                      </mat-label>
                      <mat-form-field floatLabel="never">
                        <input
                          (input)="
                            changeLink('supportPhone', $event.target.value)
                          "
                          formControlName="supportPhone"
                          matInput
                        />
                        <mat-error *ngIf="supportPhone.invalid">{{
                          validateError(supportPhone)
                        }}</mat-error>
                      </mat-form-field>
                    </div>
                  </td>
                </tr>
              </table>
            </div>

            <div
              class="preview-container"
              [style.background-color]="appStyle.backgroundColor"
            >
              <div
                class="preview-div-body"
                style="
                  padding-right: 10px;
                  padding-top: 10px;
                  width: 75%;
                  height: 75%;
                  bottom: 0;
                  left: 0;
                  border-radius: 0;
                  border-top-right-radius: 10px;
                "
              >
                <h4
                  style="
                    margin-top: 20%;
                    margin-right: 20%;
                    float: right;
                    top: 0;
                    right: 0;
                  "
                >
                  Help ?
                </h4>
              </div>
            </div>

            <div>
              <h4 class="topic">
                Add footer links
                <mat-icon
                  svgIcon="infoicon"
                  class="tooltipicon"
                  inline="true"
                  matTooltip="Include your Terms page, Shipping policy, Return policy, Privacy page and more"
                  matTooltipPosition="after"
                >
                </mat-icon>
              </h4>
              <p class="description">
                Allow customers to access important links of your website
                through the footer section
              </p>

              <table
                formArrayName="footers"
                style="width: 82%"
                class="table-container"
              >
                <tbody>
                  <tr
                    *ngFor="
                      let footer of getFooterLinks.controls;
                      let i = index
                    "
                    [formGroupName]="i"
                  >
                    <td>
                      <div class="form-container">
                        <mat-form-field floatLabel="never" style="margin: 0">
                          <input
                            formControlName="name"
                            (input)="
                              links.footers[i].name = $event.target.value
                            "
                            matInput
                            placeholder="Link name"
                          />
                        </mat-form-field>
                      </div>
                    </td>
                    <td>
                      <div class="form-container">
                        <mat-form-field
                          floatLabel="never"
                          style="margin: 0 10px"
                        >
                          <input
                            formControlName="url"
                            (input)="
                              links.footers[i]['url'] = $event.target.value
                            "
                            matInput
                            placeholder="https://"
                          />
                        </mat-form-field>
                      </div>
                    </td>
                    <td style="margin: 3px" align="center" valign="center">
                      <mat-icon
                        (click)="removeFooter(i)"
                        svgIcon="deletebin"
                      ></mat-icon>
                    </td>
                  </tr>
                  <tr>
                    <button
                      type="button"
                      (click)="addFooter()"
                      mat-flat-button
                      style="
                        height: min-content;
                        color: #fa5c5d;
                        border: none;
                        margin: 0;
                        padding: 0;
                      "
                      #addLinksButton
                      *ngIf="links.footers.length < 3"
                    >
                      + Add links
                    </button>
                    <p>Max. 3 links</p>
                  </tr>
                </tbody>
              </table>
            </div>
            <div>
              <button class="save-button" type="submit" mat-button>Save</button>
              <button type="button" mat-button>Cancel</button>
            </div>
          </div>
        </form>
      </div>
    </mat-expansion-panel>
  </mat-accordion>
  <!--pre>{{styleFormGroup.value | json}}</pre>
  <pre>{{appStyle | json}}</pre>
  <pre>{{linksFormGroup.value | json}}</pre-->
</div>
